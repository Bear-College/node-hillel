# üì¶ Load Balancer Benchmark (Node.js)

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è **–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö –ø—ñ–¥—Ö–æ–¥—ñ–≤ –¥–æ –æ–±—Ä–æ–±–∫–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ Node.js**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:
- `cluster`
- `worker_threads`
- `http-proxy`
- —Ä—É—á–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é Round Robin

> ‚úÖ –¶—ñ–ª—å ‚Äî –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è CPU-bound –∑–∞–ø–∏—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–∞–ª–∞).

---

## üîß –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç
chmod +x setup-load-balancer-tests.sh
./setup-load-balancer-tests.sh

# 2. –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
cd load-balancer-benchmark

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
./benchmark.sh
```

> –£—Å—ñ –ø—ñ–¥—Ö–æ–¥–∏ —Ç–µ—Å—Ç—É—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `autocannon` –Ω–∞ 100 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –∑‚Äô—î–¥–Ω–∞–Ω—å –ø—Ä–æ—Ç—è–≥–æ–º 10 —Å–µ–∫—É–Ω–¥.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
load-balancer-benchmark/
‚îú‚îÄ‚îÄ factorial.js                 # –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–∞–ª–∞
‚îú‚îÄ‚îÄ server-thread.js             # –ü–æ—Ç—ñ–∫ –¥–ª—è —Ñ–∞–∫—Ç–æ—Ä—ñ–∞–ª–∞
‚îú‚îÄ‚îÄ proxy-thread-server.js       # –ü–æ—Ç–æ–∫–æ–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏ –¥–ª—è proxy
‚îú‚îÄ‚îÄ benchmark.sh                 # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ –∑ autocannon
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ test1-single-thread.js         # –û–¥–∏–Ω –ø–æ—Ç—ñ–∫ (baseline)
‚îÇ   ‚îú‚îÄ‚îÄ test2-worker-threads.js        # Worker Threads
‚îÇ   ‚îú‚îÄ‚îÄ test3-cluster-rr.js            # Cluster –∑ –≤–±—É–¥–æ–≤–∞–Ω–∏–º RR
‚îÇ   ‚îú‚îÄ‚îÄ test4-cluster-threads-rr.js    # Cluster + Worker Threads + Custom RR
‚îÇ   ‚îî‚îÄ‚îÄ test5-proxy-rr.js              # Proxy + Thread servers + RR
```

---

## ü¶ö –û–ø–∏—Å –∫–æ–∂–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É

| –¢–µ—Å—Ç  | –ù–∞–∑–≤–∞                        | –°—É—Ç—å –ø—ñ–¥—Ö–æ–¥—É |
|--------|------------------------------|---------------|
| 1     | `Single Thread`             | –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤ –≥–æ–ª–æ–≤–Ω–æ–º—É –ø–æ—Ç–æ—Ü—ñ |
| 2     | `Worker Threads`            | –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤ –ø–æ—Ç–æ–∫–∞—Ö |
| 3     | `Cluster + RR`              | `cluster.fork()` –Ω–∞ –≤—Å—ñ CPU, –∫–æ–∂–µ–Ω –æ–±—á–∏—Å–ª—é—î –ª–æ–∫–∞–ª—å–Ω–æ |
| 4     | `Cluster + Threads + RR`    | Master –ø–µ—Ä–µ–¥–∞—î –∑–∞–ø–∏—Ç–∏ –ø–æ Round Robin ‚Üí –≤–æ—Ä–∫–µ—Ä ‚Üí –ø–æ—Ç—ñ–∫ |
| 5     | `Proxy + Threads + RR`      | HTTP-–ø—Ä–æ–∫—Å—ñ —Ä–æ–∑–¥–∞—î –∑–∞–ø–∏—Ç–∏ –Ω–∞ –ø–æ—Ç–æ–∫–æ–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ä—Ç–∞—Ö |

---

## üåü –©–æ –¥–µ –Ω–∞–π–∫—Ä–∞—â–µ

| –ü—ñ–¥—Ö—ñ–¥                        | –ù–∞–π–∫—Ä–∞—â–µ –¥–ª—è                 |
|------------------------------|------------------------------|
| Single Thread                | Low-traffic, –Ω–∞–≤—á–∞–ª—å–Ω—ñ —Ü—ñ–ª—ñ  |
| Worker Threads               | CPU-bound, –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–∏–π API  |
| Cluster                      | –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –ø–æ —è–¥—Ä–∞—Ö       |
| Cluster + Threads + RR       | –ú–∞–∫—Å. –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º, –∫–æ–Ω—Ç—Ä–æ–ª—å   |
| Proxy + Threads              | –ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏, —ñ–∑–æ–ª—å–æ–≤–∞–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ |

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

> –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–≤–æ–¥—è—Ç—å—Å—è –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–µ—Å—Ç—É —á–µ—Ä–µ–∑ `autocannon`: RPS, latency, throughput.

---

## üìí –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- [`http-proxy`](https://www.npmjs.com/package/http-proxy)
- [`autocannon`](https://github.com/mcollina/autocannon)